For David:

Only help is a hint to fix the bug calculating balances.